<div class="archived-page">
  <!-- Fixed Top Bar -->
  <div class="fixed-top-bar">
    <div class="left-section">
      <button class="new-project-btn" (click)="goBack()">
        <lucide-icon [img]="ArrowLeft" [size]="20"></lucide-icon>
        <span>{{ 'ARCHIVED_WORKS.BACK' | translate }}</span>
      </button>

      @if (currentWorkspace(); as currentWorkspace) {
        <div class="current-project-display">
          <span class="label-text">{{ 'WORKSPACE.CURRENT' | translate }}:</span>
          <lucide-icon [img]="FolderOpen" [size]="20"></lucide-icon>
          <span class="workspace-name">{{ currentWorkspace.name }}</span>
        </div>
      }
    </div>
  </div>

  <!-- Navigation Tabs -->
  <div class="navigation-tabs">
    <button class="nav-tab" (click)="navigateTo('dashboard')">
      <lucide-icon [img]="Home" [size]="20"></lucide-icon>
      <span class="tab-label">{{ 'DASHBOARD.DASHBOARD' | translate }}</span>
    </button>

    <button class="nav-tab" (click)="navigateTo('works')">
      <lucide-icon [img]="Music" [size]="20"></lucide-icon>
      <span class="tab-label">{{ 'WORKS.WORKS' | translate }}</span>
    </button>

    <button class="nav-tab" (click)="navigateTo('rights-holders')">
      <lucide-icon [img]="Users" [size]="20"></lucide-icon>
      <span class="tab-label">{{ 'RIGHTS_HOLDERS.TITLE' | translate }}</span>
    </button>

    <button class="nav-tab" (click)="navigateTo('protocols')">
      <lucide-icon [img]="FileText" [size]="20"></lucide-icon>
      <span class="tab-label">{{ 'DASHBOARD.PROTOCOLS' | translate }}</span>
    </button>

    <button class="nav-tab active">
      <lucide-icon [img]="ArchiveIcon" [size]="20"></lucide-icon>
      <span class="tab-label">{{ 'DASHBOARD.ARCHIVE' | translate }}</span>
    </button>
  </div>

  <div class="page-content">
    <div class="page-nav-bento">
      <div class="page-nav-left">
        <button type="button" class="page-nav-back" (click)="goBack()">
          <lucide-icon [img]="ArrowLeft" [size]="18"></lucide-icon>
          <span>{{ 'ARCHIVED_WORKS.BACK' | translate }}</span>
        </button>

        <div class="page-nav-info">
          <h1>{{ 'ARCHIVED_WORKS.TITLE' | translate }}</h1>
          <p>{{ 'ARCHIVED_WORKS.SUBTITLE' | translate }}</p>
        </div>
      </div>

      <div class="page-nav-actions">
        <button
          type="button"
          class="page-nav-action"
          (click)="loadWorks()"
          [disabled]="isLoading()"
        >
          <lucide-icon [img]="RefreshCcw" [size]="18"></lucide-icon>
          <span>{{ 'ARCHIVED_WORKS.REFRESH' | translate }}</span>
        </button>
      </div>
    </div>

    <section class="status" *ngIf="isLoading() || errorMessage()">
      <div class="loading" *ngIf="isLoading()">{{ 'COMMON.LOADING' | translate }}</div>
      <div class="error" *ngIf="errorMessage()">{{ errorMessage() | translate }}</div>
    </section>

    <section class="search-bar" *ngIf="!isLoading() && !errorMessage()">
      <div class="search-input">
        <lucide-icon [img]="Archive" [size]="18"></lucide-icon>
        <input
          type="text"
          [value]="searchQuery()"
          (input)="onSearchChange($any($event.target).value)"
          [placeholder]="'ARCHIVED_WORKS.SEARCH_PLACEHOLDER' | translate"
        />
        <button type="button" (click)="clearSearch()" *ngIf="searchQuery()">{{ 'COMMON.CLEAR' | translate }}</button>
      </div>
    </section>

    <section class="archived-list" *ngIf="!isLoading() && !errorMessage()">
      <ng-container *ngIf="filteredArchivedWorks().length; else archiveEmpty">
        <div class="archived-card" *ngFor="let work of filteredArchivedWorks()" (click)="openWork(work)">
          <div class="card-header">
            <div class="titles">
              <h3>{{ work.work_title }}</h3>
            </div>
            <span class="status-pill">{{ 'ARCHIVED_WORKS.ARCHIVED_LABEL' | translate }}</span>
          </div>

          <div class="card-meta">
            <span *ngIf="work.isrc">
              <strong>{{ 'ARCHIVED_WORKS.ISRC' | translate }}:</strong>
              {{ work.isrc }}
            </span>
            <span *ngIf="work.iswc">
              <strong>{{ 'ARCHIVED_WORKS.ISWC' | translate }}:</strong>
              {{ work.iswc }}
            </span>
            <span>
              <strong>{{ 'ARCHIVED_WORKS.UPDATED' | translate }}:</strong>
              {{ work.updated_at | date:'medium' }}
            </span>
          </div>

          <div class="card-actions" (click)="$event.stopPropagation()">
            <button type="button" class="restore-btn" (click)="restoreWork(work, $event)">
              <lucide-icon [img]="RotateCcw" [size]="16"></lucide-icon>
              <span>{{ 'ARCHIVED_WORKS.RESTORE' | translate }}</span>
            </button>
            <button type="button" class="open-btn" (click)="openWork(work)">
              {{ 'ARCHIVED_WORKS.OPEN' | translate }}
            </button>
          </div>
        </div>
      </ng-container>
    </section>

    <ng-template #archiveEmpty>
      <div class="empty-state">
        <lucide-icon [img]="Archive" [size]="72" [strokeWidth]="1.5"></lucide-icon>
        <h3>{{ 'ARCHIVED_WORKS.EMPTY_TITLE' | translate }}</h3>
        <p>{{ 'ARCHIVED_WORKS.EMPTY_DESC' | translate }}</p>
        <button type="button" (click)="goBack()">{{ 'ARCHIVED_WORKS.BACK_TO_DASHBOARD' | translate }}</button>
      </div>
    </ng-template>
  </div>
</div>
