<div class="dashboard-container">
  <!-- Header -->
  <div class="dashboard-header">
    <h1>{{ 'DASHBOARD.WELCOME' | translate }}</h1>
    <button (click)="logout()" class="logout-btn">
      {{ 'DASHBOARD.LOGOUT' | translate }}
    </button>
  </div>

  @if (profile$ | async; as profile) {
    <!-- Bento Grid Layout -->
    <div class="bento-grid">
      
      <!-- Profile Card (Main) -->
      <div class="bento-card profile-main">
        <div class="profile-header-section">
          <div class="profile-title-row">
            <h2>{{ 'DASHBOARD.YOUR_PROFILE' | translate }}</h2>
            <button (click)="toggleProfileDetails()" class="toggle-btn">
              <span class="toggle-icon">{{ profileDetailsVisible() ? '‚ñº' : '‚ñ∂' }}</span>
            </button>
          </div>
          
          <div class="profile-quick-info">
            <div class="quick-info-item">
              <span class="label">@{{ profile.nickname }}</span>
            </div>
            <div class="quick-info-item">
              <span class="badge">{{ profile.primary_role }}</span>
            </div>
          </div>

          <div class="profile-actions">
            <button (click)="editProfile()" class="action-btn edit">
              <span class="icon">‚úèÔ∏è</span>
              <span>{{ 'DASHBOARD.EDIT_PROFILE' | translate }}</span>
            </button>
            <button (click)="viewQRCode()" class="action-btn qr">
              <span class="icon">üì±</span>
              <span>{{ 'DASHBOARD.VIEW_QR_CODE' | translate }}</span>
            </button>
          </div>
        </div>

        <!-- Collapsible Details -->
        @if (profileDetailsVisible()) {
          <div class="profile-details-section">
            <div class="detail-item">
              <label>{{ 'DASHBOARD.USER_NUMBER' | translate }}</label>
              <span class="value">#{{ profile.user_number }}</span>
            </div>
            @if (profile.bio) {
              <div class="detail-item">
                <label>{{ 'DASHBOARD.BIO' | translate }}</label>
                <span class="value bio">{{ profile.bio }}</span>
              </div>
            }
            <div class="detail-item">
              <label>{{ 'DASHBOARD.EMAIL' | translate }}</label>
              <span class="value">{{ user?.email }}</span>
            </div>
          </div>
        }
      </div>

      <!-- Social Links Cards -->
      @for (platform of socialPlatforms; track platform.key) {
        @if (getSocialLink(profile, platform.key); as link) {
          <div class="bento-card social-card" [style.--accent-color]="platform.color">
            <div class="social-header">
              <span class="social-icon">{{ platform.icon }}</span>
              <span class="social-name">{{ platform.label }}</span>
            </div>
            <div class="social-content">
              <a [href]="link" target="_blank" class="social-link">
                {{ link.length > 30 ? (link | slice:0:30) + '...' : link }}
              </a>
            </div>
            <div class="social-actions">
              <button 
                (click)="copyToClipboard(link, platform.label)" 
                class="copy-btn"
                title="Copy link">
                <span class="copy-icon">üìã</span>
              </button>
              <a 
                [href]="link" 
                target="_blank" 
                class="visit-btn"
                title="Visit">
                <span class="visit-icon">‚Üó</span>
              </a>
            </div>
          </div>
        }
      }

    </div>
  }

  <!-- Workspaces Section -->
  <div class="workspaces-section">
    <div class="section-header">
      <h2>{{ 'DASHBOARD.YOUR_WORKSPACES' | translate }}</h2>
      <button (click)="goToWorkspaces()" class="manage-btn">
        {{ 'WORKSPACE.MANAGE_WORKSPACES' | translate }}
      </button>
    </div>

    @if (workspaces$ | async; as workspaces) {
      <div class="workspace-list">
        @if (workspaces.length === 0) {
          <div class="no-workspaces">
            <p>{{ 'DASHBOARD.NO_WORKSPACES' | translate }}</p>
            <button (click)="goToWorkspaces()" class="create-workspace-btn">
              {{ 'DASHBOARD.CREATE_FIRST_WORKSPACE' | translate }}
            </button>
          </div>
        }

        @if (workspaces.length > 0) {
          <div class="workspace-cards">
            @for (workspace of workspaces; track workspace.id) {
              <div class="workspace-card">
                <h3>{{ workspace.name }}</h3>
                <span class="workspace-type">{{ workspace.type }}</span>
              </div>
            }
          </div>
        }
      </div>
    }

    @if (currentWorkspace) {
      <div class="current-workspace">
        <p>{{ 'DASHBOARD.CURRENT_WORKSPACE' | translate }}: <strong>{{ currentWorkspace.name }}</strong></p>
      </div>
    }
  </div>
</div>